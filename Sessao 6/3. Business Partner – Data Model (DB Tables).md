## 📒 Business Partner – Data Model (DB Tables)

### 1️⃣ Revisão rápida

Já vimos:

- O que é um Business Partner (BP).

- Como criar BP genérico.

- Como estender BP com roles para criar Customer ou Vendor.

Agora vamos ver o que acontece por trás dos panos no banco de dados.

### 2️⃣ Customer/Vendor Master – Estrutura Antiga

**Customer Master:**

Tabela | Dados armazenados
-------|-----------------
KNA1   | General Data
KNB1   | Company / Finance Data
KNVV   | Sales Data


**Vendor Master:**

Tabela | Dados armazenados
-------|-----------------
LFA1   | General Data
LFB1   | Company Code / Finance Data
LFM1   | Purchasing Data


- Cada Customer/Vendor tinha três views, espalhadas em diferentes tabelas.

### 3️⃣ Business Partner – Estrutura Nova

- BP é uma shell: contém dados gerais (nome, endereço, contato).

- Tabela principal: BUT000 (zero zero zero) → armazena dados gerais de todos os BPs.

- Criação do BP não cria Customer/Vendor imediatamente.

### 4️⃣ Extensão do BP para Customer/Vendor

- Quando um BP é estendido com roles, as tabelas clássicas do Customer/Vendor passam a ser preenchidas:

**Customer**

| Role   | Tabela preenchida             | Exemplo                                  |
| ------ | ----------------------------- | ---------------------------------------- |
| FLCU00 | KNB1 (Company Code / Finance) | Contas a receber, recon account          |
| FLCU01 | KNVV (Sales Data)             | Sales Area, Shipping, Tax, Partner Func. |

**Vendor**

| Role   | Tabela preenchida             | Exemplo                       |
| ------ | ----------------------------- | ----------------------------- |
| FLVN00 | LFB1 (Finance / Company Code) | Contas a pagar, recon account |
| FLVN01 | LFM1 (Purchasing)             | Purchase Org, Currency, Terms |


- BP Number (ex.: 63) → número do BP genérico

- Customer/Vendor Number → número específico criado ao estender o BP

- Pode ser o mesmo número do BP ou diferente, dependendo da configuração.

### 5️⃣ Passo a passo – Exemplo Vendor

- Criar BP genérico (ex.: Bank of America, BP 63) → armazenado em BUT000.

- Adicionar Role FLVN00 (Finance) → dados preenchidos em LFB1 → Vendor Number criado (ex.: 100013).

- Adicionar Role FLVN01 (Purchasing) → dados preenchidos em LFM1.

Observação: até o BP ser estendido com roles, as tabelas antigas de Customer/Vendor permanecem vazias.

### 6️⃣ Pontos importantes

- BP é shell genérica → Customer/Vendor é criado somente ao estender roles.

- Cada role ativa abas e tabelas correspondentes.

- BP permite integração simplificada e compatibilidade com S/4HANA.

- Tabelas antigas ainda são utilizadas para compatibilidade, programas legados não falham.

- Além das tabelas principais, existem outras tabelas relacionadas:

- Tax Tables

- VAT Registration Tables

- Outros dados específicos de Customer/Vendor

### 7️⃣ Fluxo resumido (numérico)
```
1️⃣ Criar BP genérico → BUT000<br>
2️⃣ Extender BP como Customer → FLCU00 / FLCU01 → KNB1 / KNVV<br>
3️⃣ Extender BP como Vendor   → FLVN00 / FLVN01 → LFB1 / LFM1

```

## ✅ Resumo visual

```
BP (BUT000)
   │
   ├── Customer Role
   │      ├─ FLCU00 → KNB1 (Finance)
   │      └─ FLCU01 → KNVV (Sales)
   │
   └── Vendor Role
          ├─ FLVN00 → LFB1 (Finance)
          └─ FLVN01 → LFM1 (Purchasing)
```