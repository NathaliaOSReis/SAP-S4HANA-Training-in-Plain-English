## 🔹 O que é um índice no banco de dados?

Um índice é uma estrutura auxiliar (como o índice de um livro) que ajuda o banco de dados a encontrar registros rapidamente sem precisar varrer toda a tabela linha por linha (full table scan).

Ele é criado sobre uma ou mais colunas de uma tabela.

Exemplo: se você sempre busca materiais pelo MATNR (código do material), o SAP cria um índice sobre essa coluna em MARA.

## 🔹 Por que os índices eram necessários no SAP ECC?

**1. Performance**

Os bancos tradicionais (Oracle, SQL Server, DB2) armazenavam dados em disco, e varrer milhões de registros era muito lento.

Índices reduziam o tempo de busca drasticamente.

**2. Consultas frequentes**

Documentos financeiros, logísticos e de vendas precisavam ser consultados e conciliados com frequência.

Exemplo: relatórios de saldos de contas precisavam de BSIS (índice de saldos abertos), em vez de recalcular tudo em cima do BKPF/BSEG a cada consulta.

**3. Relatórios e integrações**

Muitas consultas eram analíticas (saldos, totais, históricos). Para não sobrecarregar as tabelas básicas, os índices funcionavam como cópias resumidas.

👉 Resumindo: os índices existiam para **compensar a limitação de hardware e dos bancos de dados relacionais.**

## 🔹 O que muda no SAP S/4HANA?

O SAP HANA é um banco in-memory columnar (colunar na memória), que já traz performance muito alta para consultas analíticas e transacionais.

Ele não precisa de tabelas de índice redundantes, porque consegue:

- Buscar registros rapidamente usando armazenamento em colunas.

- Fazer agregações em tempo real (sum, avg, count etc.) sem tabelas intermediárias.

- Manter apenas uma fonte única de dados (ex.: a tabela ACDOCA substitui várias antigas de FI/CO).

👉 Por isso, no S/4HANA, as index tables foram eliminadas. Hoje se usa views (CDS views) para consultas otimizadas sem redundância.

📌 Resumo para anotações:

- Índices eram necessários no ECC porque os bancos relacionais eram lentos → evitavam full scans e guardavam resultados pré-calculados.

- No HANA, a performance é garantida pelo design in-memory e column-store, então não precisamos de tabelas de índice redundantes.

## 🔹 O que significa VBAK e outras “tables” do SAP

- No **SAP**, cada tabela tem um nome técnico (geralmente 4 ou 5 letras) e guarda dados específicos.

Exemplo clássico:

- **VBAK** → Sales Document: Header Data (cabeçalho do pedido de vendas)

- **VBAP** → Sales Document: Item Data (itens do pedido de vendas)

- **BKPF** → Cabeçalho de documento contábil (FI)

- **BSEG** → Linhas de documento contábil (FI)

- **MARA** → Dados mestre de material

👉 Essas são basic tables → as tabelas originais onde os dados são gravados no momento da transação.

## 🔹 Como VBAK se relaciona com os conceitos que vimos

#### **1. Basic Tables**

- VBAK é um exemplo perfeito de basic table.

- Quando você cria um pedido de vendas no SAP (SD), o cabeçalho vai para a VBAK, e os itens vão para VBAP.

- Essas tabelas sempre existiram e continuam existindo no S/4HANA.

#### **2.Index Tables (ECC, antes do S/4HANA)**

- Antes do HANA, se alguém pedisse: “Liste todos os pedidos de vendas do cliente X que já foram entregues mas não faturados”, o sistema precisaria varrer VBAK + VBAP + LIKP + VBRK (muitas tabelas, milhões de registros).

- Para acelerar, o SAP criava index tables que já tinham essa informação pré-calculada.

- Exemplo em FI: BSIS (índice de documentos abertos).

👉 No S/4HANA, isso desapareceu → o HANA consegue juntar VBAK, VBAP, etc. em tempo real via CDS Views.

#### **3.LIS Tables (Logistics Information System)**

- Ainda no ECC, existiam tabelas LIS como S001, S002 que guardavam estatísticas de vendas (quantos pedidos, faturamento por cliente, etc.).

- Essas tabelas eram “sumários” baseados em dados de VBAK/VBAP.

- No S/4HANA, isso foi substituído por analytics embarcados, sem LIS tables.

#### **4.Status Tables**

- Um pedido de vendas (em VBAK/VBAP) precisa de status: “aberto”, “liberado para entrega”, “faturado”, etc.

- Isso é guardado em status tables como VBUK (status do documento de vendas) e VBUP (status de item).

- Essas ainda existem no S/4HANA porque são necessárias para o processo.

## 🔹 Linha do tempo para anotar

👉 ECC (antigo)

- Criava o pedido → gravava em VBAK/VBAP (basic tables).

- Para relatórios rápidos → usava index tables (BSIS, KONV, etc.).

- Para estatísticas logísticas → usava LIS tables (S001, S002, etc.).

👉 S/4HANA (novo)

- Continua gravando no VBAK/VBAP.

- Index tables e LIS tables foram eliminadas.

- Tudo é feito em tempo real via HANA + CDS Views + Fiori apps.

- Status tables (VBUK, VBUP, JEST) continuam existindo.

📌 Resumo prático:

- VBAK = basic table (cabeçalho de pedidos de vendas).

- VBAP = basic table (itens de pedidos de vendas).

- VBUK/VBUP = status tables relacionadas a VBAK/VBAP.

- No ECC, relatórios sobre VBAK/VBAP usavam index e LIS tables para não pesar no banco.

- No S/4HANA, essas redundâncias sumiram → HANA faz tudo em tempo real.